
base_experiment: # the base config object  
  environment:
    num_clients: 3383
    num_selected_clients: 30
    num_malicious_clients: 113
    num_selected_malicious_clients: 1
    experiment_name: "backdoor_tasks_bound_lenet"
    use_config_dir: true
    attack_frequency: 1.0
    attacker_full_knowledge: true
    load_model: ./models/lenet5_emnist_088.h5
  server:
    num_rounds: 600
    num_test_batches: 50
    aggregator:
      name: FedAvg
    global_learning_rate: -1
  client:
    model_name: lenet5_mnist
    clip:
      type: median_l2
      value: 1.5
    benign_training:
      num_epochs: 5
      batch_size: 32
      optimizer: SGD
      learning_rate: 0.01
    malicious:
      objective:
        name: TargetedAttack
        args:
          num_epochs: 5
          num_batch: 3
          poison_samples: 12
          optimizer: SGD
          learning_rate: 0.01
          step_decay: ~
          reduce_lr: false
          attacker_full_dataset: false
      backdoor:
        type: tasks
        tasks: 30
        source_label: 7
        target_label: 1
        aux_samples: -1
        augment_times: 0
      evasion: ~
  dataset:
    dataset: femnist
    data_distribution: nonIID
  job:
    minutes: 240 # Max. minutes to run. Leonhard has 240 and 1440 queues
    cpu_cores: 20
    cpu_mem_per_core: 4096
    use_gpu: 1
    gpu_memory_min: 10240

experiments: # in the experiments object you have a list for the different experiments with the values for the fields marked as $VARIES$ in the base config object.

# PGD

#- client: # baseline
#    malicious:
#      backdoor:
#        type: tasks
#      objective:
#        name: TargetedAttack
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: median_l2
#          pgd_factor: 1.
#          scale_factor: 30
#
#- client: # baseline
#    malicious:
#      backdoor:
#        type: edge
#        edge_case_type: EuropeanSevenEdgeCase
#        edge_case_p: 0.9
#      objective:
#        name: TargetedAttack
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: median_l2
#          pgd_factor: 1.
#          scale_factor: 30
#
#- client: # baseline
#    malicious:
#      backdoor:
#        type: edge
#        edge_case_type: FEMNISTRandomNoiseEdgeCase
#        augment_data: true
#        augment_times: 50
#      objective:
#        name: TargetedAttack
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: median_l2
#          pgd_factor: 1.
#          scale_factor: 30
#
#- client: # baseline
#    malicious:
#      backdoor:
#        type: pixel_pattern
#        target_label: 9
#      objective:
#        name: TargetedAttack
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: median_l2
#          pgd_factor: 1.
#          scale_factor: 30
#
## Anticipate
#
- client:
    malicious:
      backdoor:
        type: tasks
      objective:
        name: AnticipateTfAttack
        args:
          num_epochs: 2
          num_batch: 25
          step_decay: true
          learning_rate: 0.1
          anticipate_steps: 5
      evasion:
        name: NormBoundPGDEvasion
        args:
          norm_type: median_l2
          scale_factor: 30

- client:
    malicious:
      backdoor:
        type: edge
        edge_case_type: EuropeanSevenEdgeCase
        edge_case_p: 0.9
      objective:
        name: AnticipateTfAttack
        args:
          num_epochs: 2
          num_batch: 25
          step_decay: true
          learning_rate: 0.1
          anticipate_steps: 5
      evasion:
        name: NormBoundPGDEvasion
        args:
          norm_type: median_l2
          scale_factor: 30

- client: # baseline
    malicious:
      backdoor:
        type: edge
        edge_case_type: FEMNISTRandomNoiseEdgeCase
        augment_data: true
        augment_times: 50
      objective:
        name: AnticipateTfAttack
        args:
          num_epochs: 2
          num_batch: 25
          step_decay: true
          learning_rate: 0.1
          anticipate_steps: 5
      evasion:
        name: NormBoundPGDEvasion
        args:
          norm_type: median_l2
          scale_factor: 30

- client: # baseline
    malicious:
      backdoor:
        type: pixel_pattern
        target_label: 9
      objective:
        name: AnticipateTfAttack
        args:
          num_epochs: 2
          num_batch: 25
          step_decay: true
          learning_rate: 0.1
          anticipate_steps: 5
      evasion:
        name: NormBoundPGDEvasion
        args:
          norm_type: median_l2
          scale_factor: 30
#
## Neurotoxin
#
#- client: # baseline
#    malicious:
#      attack_start: 2
#      backdoor:
#        type: tasks
#      objective:
#        name: TargetedAttack
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NeurotoxinEvasion
#        args:
#          norm_type: median_l2
#          scale_factor: 30
#          topk: 5
#
#- client: # baseline
#    malicious:
#      attack_start: 2
#      backdoor:
#        type: edge
#        edge_case_type: EuropeanSevenEdgeCase
#        edge_case_p: 0.9
#      objective:
#        name: TargetedAttack
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NeurotoxinEvasion
#        args:
#          norm_type: median_l2
#          scale_factor: 30
#          topk: 5
#
#- client: # baseline
#    malicious:
#      attack_start: 2
#      backdoor:
#        type: edge
#        edge_case_type: FEMNISTRandomNoiseEdgeCase
#        augment_data: true
#        augment_times: 50
#      objective:
#        name: TargetedAttack
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NeurotoxinEvasion
#        args:
#          norm_type: median_l2
#          scale_factor: 30
#          topk: 5
#
#- client: # baseline
#    malicious:
#      attack_start: 2
#      backdoor:
#        type: pixel_pattern
#        target_label: 9
#      objective:
#        name: TargetedAttack
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NeurotoxinEvasion
#        args:
#          norm_type: median_l2
#          scale_factor: 30
#          topk: 5
#
## Undefended
#
#- client: # baseline
#    clip: ~
#    malicious:
#      backdoor:
#        type: tasks
#      objective:
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: l2
#          pgd_factor: ~
#          scale_factor: 30
#- client: # baseline
#    clip: ~
#    malicious:
#      backdoor:
#        type: edge
#        edge_case_type: EuropeanSevenEdgeCase
#        edge_case_p: 0.9
#      objective:
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: l2
#          pgd_factor: ~
#          scale_factor: 30
#
#- client: # baseline
#    clip: ~
#    malicious:
#      backdoor:
#        type: edge
#        edge_case_type: FEMNISTRandomNoiseEdgeCase
#        augment_data: true
#        augment_times: 50
#      objective:
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: l2
#          pgd_factor: ~
#          scale_factor: 30
#- client: # baseline
#    clip: ~
#    malicious:
#      backdoor:
#        type: pixel_pattern
#        target_label: 9
#      objective:
#        args:
#          num_epochs: 10
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: l2
#          pgd_factor: ~
#          scale_factor: 30
#
## Blackbox
#
#- client: # baseline
#    malicious:
#      backdoor:
#        type: tasks
#
#- client: # baseline
#    malicious:
#      backdoor:
#        type: edge
#        edge_case_type: EuropeanSevenEdgeCase
#        edge_case_p: 0.9
#
#- client: # baseline
#    malicious:
#      backdoor:
#        type: edge
#        edge_case_type: FEMNISTRandomNoiseEdgeCase
#        augment_data: true
#        augment_times: 50
#
#- client: # baseline
#    malicious:
#      backdoor:
#        type: pixel_pattern
#        target_label: 9



#- client:
#    malicious:
#      backdoor:
#        type: tasks
#      objective:
#        name: AnticipateTfAttack
#        args:
#          num_epochs: 2
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: median_l2
#          scale_factor: 30
#
#- client:
#    malicious:
#      backdoor:
#        type: edge
#        edge_case_type: EuropeanSevenEdgeCase
#        edge_case_p: 0.9
#      objective:
#        name: AnticipateTfAttack
#        args:
#          num_epochs: 2
#          num_batch: 25
#          step_decay: true
#          learning_rate: 0.1
#      evasion:
#        name: NormBoundPGDEvasion
#        args:
#          norm_type: median_l2
#          scale_factor: 30
