
base_experiment: # the base config object  
  environment:
    num_clients: 100
    num_selected_clients: 40
    num_malicious_clients: $VARIES$
    experiment_name: "cifar_bounds"
    use_config_dir: true
    attack_frequency: 1.0
    load_model: ./models/resnet18_080.h5
  server:
    num_rounds: 550
    num_test_batches: 50
    aggregator:
      name: FedAvg
    global_learning_rate: 1.0
  client:
    model_name: resnet18
    clip:
#      type: l2
#      value: 3.0
      type: median_l2
      value: 1.5
    benign_training:
      num_epochs: 2
      batch_size: 64
      optimizer: SGD
      learning_rate: 0.02
    malicious:
      attack_start: 5
      attack_stop: 1005
      multi_attacker_scale_divide: true
      objective:
        name: TargetedAttack
        args:
          num_epochs: 6
          step_decay: true
          poison_samples: 20
          learning_rate: 0.1
          num_batch: 10
          optimizer: SGD
      backdoor:
        type: semantic
        train: [389,561,874,41861,3378,3678,4528,9744,19165,19500,21422,22984,32941,34287,34385,36005,37365,37533,38658,38735,39824,40138,47026,48003,48030,49163,49588]
        test: [41336,1605,47001]
        target_label: 2
        remove_from_benign_dataset: true
        augment_times: 200
        augment_data: true
      evasion:
        name: NormBoundPGDEvasion
        args:
          norm_type: l2
          scale_factor: $VARIES$
  dataset:
    dataset: cifar10
    data_distribution: dirichlet
    augment_data: true # for training
  job:
    minutes: 1440 # Max. minutes to run. Leonhard has 240 and 1440 queues
    cpu_cores: 20
    cpu_mem_per_core: 4096
    use_gpu: 1
    gpu_memory_min: 10240

experiments: # in the experiments object you have a list for the different experiments with the values for the fields marked as $VARIES$ in the base config object.

#- client: # baseline
#    malicious:
#      evasion:
#        args:
#          scale_factor: 100.0
#          pgd_factor: 0.0375
#  environment:
#    num_malicious_clients: 1
#
#- client: # baseline
#    malicious:
#      evasion:
#        args:
#          scale_factor: 50.0
#          pgd_factor: 0.075
#  environment:
#    num_malicious_clients: 2
#
#- client: # baseline
#    malicious:
#      evasion:
#        args:
#          scale_factor: 20.0
##          pgd_factor: 0.3125
#          pgd_factor: 0.1875
#  environment:
#    num_malicious_clients: 5
#- client: # baseline
#    malicious:
#      evasion:
#        args:
#          scale_factor: 10.
##          pgd_factor: 0.625
#          pgd_factor: 0.375
#  environment:
#    num_malicious_clients: 10
##- client: # baseline
##    malicious:
##      evasion:
##        args:
##          scale_factor: 6.6666667
###          pgd_factor: 0.9374
##          pgd_factor: 0.5625
##  environment:
##    num_malicious_clients: 15
#- client: # baseline
#    malicious:
#      evasion:
#        args:
#          scale_factor: 5
##          pgd_factor: 1.25
#          pgd_factor: 0.75
#  environment:
#    num_malicious_clients: 20
###- client: # baseline
###    malicious:
###      evasion:
###        args:
###          scale_factor: 4
###          pgd_factor: 1.5625
###  environment:
###    num_malicious_clients: 25
###
###
##### BLACKBOX
#- client: # baseline
#    malicious:
#      multi_attacker_scale_divide: false
#      objective:
#        args:
#          num_epochs: 2
#          num_batch: 9
#          step_decay: ~
#          learning_rate: 0.02
#      evasion: ~
#  environment:
#    num_malicious_clients: 1
#- client: # baseline
#    malicious:
#      multi_attacker_scale_divide: false
#      objective:
#        args:
#          num_epochs: 2
#          num_batch: 9
#          step_decay: ~
#          learning_rate: 0.02
#      evasion: ~
#  environment:
#    num_malicious_clients: 2
#- client: # baseline
#    malicious:
#      multi_attacker_scale_divide: false
#      objective:
#        args:
#          num_epochs: 2
#          num_batch: 9
#          step_decay: ~
#          learning_rate: 0.02
#      evasion: ~
#  environment:
#    num_malicious_clients: 5
#- client: # baseline
#    malicious:
#      multi_attacker_scale_divide: false
#      objective:
#        args:
#          num_epochs: 2
#          num_batch: 9
#          step_decay: ~
#          learning_rate: 0.02
#      evasion: ~
#  environment:
#    num_malicious_clients: 10
##- client: # baseline
##    malicious:
##      multi_attacker_scale_divide: false
##      objective:
##        args:
##          num_epochs: 2
##          num_batch: 9
##          step_decay: ~
##          learning_rate: 0.02
##      evasion: ~
##  environment:
##    num_malicious_clients: 15
#- client: # baseline
#    malicious:
#      multi_attacker_scale_divide: false
#      objective:
#        args:
#          num_epochs: 2
#          num_batch: 9
#          step_decay: ~
#          learning_rate: 0.02
#      evasion: ~
#  environment:
#    num_malicious_clients: 20


# Anticipate


- client: # baseline
    malicious:
      objective:
        name: AnticipateTfAttack
        args:
          num_epochs: 2
          num_batch: 10
          learning_rate: 0.1
          step_decay: true
          model_type: resnet18
          anticipate_steps: 9
      evasion:
        args:
          scale_factor: 100.0
          pgd_factor: ~
  environment:
    num_malicious_clients: 1
  job:
    minutes: 2400
    gpu_memory_min: 20000

- client: # baseline
    malicious:
      objective:
        name: AnticipateTfAttack
        args:
          num_epochs: 2
          num_batch: 10
          learning_rate: 0.1
          step_decay: true
          model_type: resnet18
          anticipate_steps: 9
      evasion:
        args:
          scale_factor: 50.0
          pgd_factor: ~
  environment:
    num_malicious_clients: 2
  job:
    minutes: 2400
    gpu_memory_min: 20000
- client: # baseline
    malicious:
      objective:
        name: AnticipateTfAttack
        args:
          num_epochs: 2
          num_batch: 10
          learning_rate: 0.1
          step_decay: true
          model_type: resnet18
          anticipate_steps: 9
      evasion:
        args:
          scale_factor: 20.0
          pgd_factor: ~
  environment:
    num_malicious_clients: 5
  job:
    minutes: 2400
    gpu_memory_min: 20000
- client: # baseline
    malicious:
      objective:
        name: AnticipateTfAttack
        args:
          num_epochs: 2
          num_batch: 10
          learning_rate: 0.1
          step_decay: true
          model_type: resnet18
          anticipate_steps: 9
      evasion:
        args:
          scale_factor: 10.
          pgd_factor: ~
  environment:
    num_malicious_clients: 10
  job:
    minutes: 2400
    gpu_memory_min: 20000
- client: # baseline
    malicious:
      objective:
        name: AnticipateTfAttack
        args:
          num_epochs: 2
          num_batch: 10
          learning_rate: 0.1
          step_decay: true
          model_type: resnet18
          anticipate_steps: 9
      evasion:
        args:
          scale_factor: 5
          pgd_factor: ~
  environment:
    num_malicious_clients: 20
  job:
    minutes: 2400
    gpu_memory_min: 20000



# Neurotoxin
- client: # baseline
    malicious:
      evasion:
        name: NeurotoxinEvasion
        args:
          scale_factor: 100.0
          topk: 5
  environment:
    num_malicious_clients: 1

- client: # baseline
    malicious:
      evasion:
        name: NeurotoxinEvasion
        args:
          scale_factor: 50.0
          topk: 5
  environment:
    num_malicious_clients: 2
- client: # baseline
    malicious:
      evasion:
        name: NeurotoxinEvasion
        args:
          scale_factor: 20.0
          topk: 5
  environment:
    num_malicious_clients: 5
- client: # baseline
    malicious:
      evasion:
        name: NeurotoxinEvasion
        args:
          scale_factor: 10.
          topk: 5
  environment:
    num_malicious_clients: 10
- client: # baseline
    malicious:
      evasion:
        name: NeurotoxinEvasion
        args:
          scale_factor: 5
          topk: 5
  environment:
    num_malicious_clients: 20