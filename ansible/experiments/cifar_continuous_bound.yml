
base_experiment: # the base config object  
  environment:
    num_clients: 100
    num_selected_clients: 40
    num_malicious_clients: 1
    experiment_name: "cifar_bounds"
    use_config_dir: true
    attack_frequency: 1.0
    attacker_full_knowledge: true
    load_model: ./models/resnet18_080.h5
  server:
    num_rounds: 1000
    num_test_batches: 50
    aggregator:
      name: FedAvg
    global_learning_rate: 1
  client:
    model_name: resnet18
    clip: ~
    benign_training:
      num_epochs: 2
      batch_size: 64
      optimizer: SGD
      learning_rate: 0.1
    malicious:
      attack_start: 5
      attack_stop: 1005
      estimate_other_updates: true
      objective:
        name: TargetedAttack
        args:
          num_epochs: 20
          num_batch: 10
          poison_samples: 16
          optimizer: SGD
          learning_rate: 0.05
          step_decay: true
      backdoor:
        type: semantic
        train: $VARIES$
        test: $VARIES$
        target_label: 2
        remove_from_benign_dataset: true
        augment_times: 200
        augment_data: true
      evasion:
        name: NormBoundPGDEvasion
        args:
          norm_type: l2
          pgd_factor: ~
          scale_factor: 100
  dataset:
    dataset: cifar10
    data_distribution: dirichlet
    augment_data: true # for training
  job:
    minutes: 1440 # Max. minutes to run. Leonhard has 240 and 1440 queues
    cpu_cores: 20
    cpu_mem_per_core: 4096
    use_gpu: 1
    gpu_memory_min: 10240

experiments: # in the experiments object you have a list for the different experiments with the values for the fields marked as $VARIES$ in the base config object.
- client: # bgwall, baseline attack
    malicious:
      backdoor:
        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
        test: [330, 30696, 40713]
      evasion:
        args:
          scale_factor: 100
    clip: ~

#- client: # bgwall, under clipping bound
#    malicious:
#      backdoor:
#        train: [389,561,874,1605,3378,3678,4528,9744,19165,19500,21422,22984,32941,34287,34385,36005,37365,37533,38658,38735,39824,40138,47026,48003,48030,49163,49588]
#        test: [41336,41861,47001]
#      evasion:
#        args:
#          scale_factor: 100
#          pgd_factor: 0.025
#    clip:
#      type: l2
#      value: 2
#
#- client: # bgwall, under clipping bound
#    malicious:
#      backdoor:
#        train: [ 2180,2771,3233,4932,6241,6813,6869,9476,11395,11744,14209,14238,18716,19793,20781,21529,31311,40518,40633,42119,42663,49392 ]
#        test: [ 42119,42663,49392 ]
#      evasion:
#        args:
#          scale_factor: 100
#          pgd_factor: 0.0625
#    clip:
#      type: l2
#      value: 5
#
#- client: # bgwall, under clipping bound
#    malicious:
#      backdoor:
#        train: [ 2180,2771,3233,4932,6241,6813,6869,9476,11395,11744,14209,14238,18716,19793,20781,21529,31311,40518,40633,42119,42663,49392 ]
#        test: [ 42119,42663,49392 ]
#      evasion:
#        args:
#          scale_factor: 100
#          pgd_factor: 0.125
#    clip:
#      type: l2
#      value: 10
#
#- client: # bgwall, under clipping bound
#    malicious:
#      backdoor:
#        train: [ 2180,2771,3233,4932,6241,6813,6869,9476,11395,11744,14209,14238,18716,19793,20781,21529,31311,40518,40633,42119,42663,49392 ]
#        test: [ 42119,42663,49392 ]
#      evasion:
#        args:
#          scale_factor: 100
#          pgd_factor: 0.1875
#    clip:
#      type: l2
#      value: 15

# BASELINE
#- client: # bgwall, baseline attack
#    malicious:
#      objective:
#        args:
#          num_epochs: 2
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.1
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion: ~
#    clip: ~
#
#- client: # bgwall, baseline attack
#    malicious:
#      objective:
#        args:
#          num_epochs: 2
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.1
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion: ~
#    clip:
#      type: l2
#      value: 2
#
#- client: # bgwall, baseline attack
#    malicious:
#      objective:
#        args:
#          num_epochs: 2
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.1
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion: ~
#    clip:
#      type: l2
#      value: 5
#
#- client: # bgwall, baseline attack
#    malicious:
#      objective:
#        args:
#          num_epochs: 2
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.1
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion: ~
#    clip:
#      type: l2
#      value: 10
#
#- client: # bgwall, baseline attack
#    malicious:
#      objective:
#        args:
#          num_epochs: 2
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.1
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion: ~
#    clip:
#      type: l2
#      value: 15






# UNTIL HERE


#- client: # bgwall, under clipping bound
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.05
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 85
#          pgd_factor: 0.029411764705882353
#    clip:
#      type: l2
#      value: 2
#
#- client: # bgwall, under clipping bound
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.05
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 85
#          pgd_factor: 0.07352941176470588
#    clip:
#      type: l2
#      value: 5
#
#- client: # bgwall, under clipping bound
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.05
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 85
#          pgd_factor: 0.14705882352941177
#    clip:
#      type: l2
#      value: 10
#
#- client: # bgwall, under clipping bound
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.05
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 85
#          pgd_factor: 0.22058823529411764
#    clip:
#      type: l2
#      value: 15
#
#- client: # bgwall, under clipping bound
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.05
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 85
#          pgd_factor: 0.29411764705882354
#    clip:
#      type: l2
#      value: 20
#
#- client: # bgwall, under clipping bound
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.05
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 85
#          pgd_factor: 0.36764705882352944
#    clip:
#      type: l2
#      value: 25

# UNCOMM

#- client: # bgwall, median
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.1
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 400
#          norm_type: median_l2
#          pgd_factor: 1.
#    clip:
#      type: median_l2
#      value: 1.
#
#- client: # bgwall, median
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.1
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 400
#          norm_type: median_l2
#          pgd_factor: 2
#    clip:
#      type: median_l2
#      value: 2
#
#- client: # bgwall, median
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.1
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 400
#          norm_type: median_l2
#          pgd_factor: 5
#    clip:
#      type: median_l2
#      value: 5
#
#- client: # bgwall, median
#    malicious:
#      objective:
#        args:
#          num_epochs: 25
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.1
#      backdoor:
#        train: [568,3934,12336,30560,33105,33615,33907,36848,41706] # bgwall
#        test: [330, 30696, 40713]
#      evasion:
#        args:
#          scale_factor: 400
#          norm_type: median_l2
#          pgd_factor: 10
#    clip:
#      type: median_l2
#      value: 10




#- client: # pixelpoison, under clipping bound
#    malicious:
#      objective:
#        args:
#          num_epochs: 40
#          step_decay: ~
#          poison_samples: 16
#          learning_rate: 0.05
#      backdoor:
#        type: pixel_pattern
#        train: []
#        test: []
#      evasion:
#        args:
#          scale_factor: 85
#    clip:
#      type: l2
#      value: 6